jQuery(function(d){var m=function(){var g=("https:"==location.protocol?"https:":"http:")+"//formoid.net/api/push",b=function(){var a=(/MSIE (\d+)\./.exec(navigator.userAgent)||[0,0])[1];return 8==a||9==a&&"file:"!=location.protocol?function(a,c){var k=new XDomainRequest,b=d.Deferred();return k.open(c.type,a),k.onload=function(){b.resolve(this.responseText)},k.onerror=function(){b.reject()},k.send(c.data),b}:(d.support.cors=!0,d.ajax)}(),e=function(a,b){return a="__"+a+"__",b.length?(this[a]=b[0],
this):this[a]},h=function(a,b,c){return d.each(c,function(c,d){a[d]=function(){return b[d].apply(b,arguments)}}),a},f=function(a){a=a||{};this.__email__=a.email||"";this.__title__=a.title||"";this.__data__=a.data||[]};return f.prototype.email=function(a){return e.call(this,"email",arguments)},f.prototype.title=function(a){return e.call(this,"title",arguments)},f.prototype.data=function(a){return e.call(this,"data",arguments)},f.prototype.send=function(a,e){var c=h(d.Deferred(),this,["email","title",
"data","send"]);return e&&(e.call(this,c),"pending"!=c.state())?c:(b(g,{type:"POST",data:JSON.stringify({email:this.__email__,form:{title:this.__title__,data:arguments.length?a:this.__data__}})}).done(function(a){try{var b=JSON.parse(a);b.error?c.reject(b.error):c.resolve(b.response)}catch(d){c.reject("Incorrect server response.")}}).fail(function(){var a;a="Failed to query the server. "+("onLine"in navigator&&!navigator.onLine?"No connection to the Internet.":"Check the connection and try again.");
c.reject(a)}),c)},{Form:function(a){return new f(a)}}}();d('[data-form-type="formoid"]').each(function(){var g,b=d(this),e=b.is("form")?b:b.find("form"),h=b.find("[data-form-alert]"),f=b.is("[data-form-title]")?b:b.find("[data-form-title]"),a=b.find('[type="submit"]');a.html('<span class="btn-text">'+a.html()+'</span><i class="btn-loader"></i>').click(function(){e.addClass("form-active")});e.submit(function(l){if(l.preventDefault(),e.addClass("form-active"),!a.hasClass("btn-loading")){var c=[];g=
g||m.Form({email:b.find("[data-form-email]").val(),title:f.attr("data-form-title")||f.text()});h.html("");a.addClass("btn-loading");b.find("[data-form-field]").each(function(){c.push([d(this).attr("data-form-field")||d(this).attr("name"),d(this).val()])});g.send(c).done(function(a){e.removeClass("form-active");b.find("[data-form-field]").val("");h.append(d('<div class="alert alert-success text-center"/>').text(a))}).fail(function(a){h.append(d('<div class="alert alert-danger text-center"/>').text(a))}).always(function(){a.removeClass("btn-loading")})}})})});
